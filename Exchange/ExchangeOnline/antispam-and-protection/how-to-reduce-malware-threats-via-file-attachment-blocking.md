---
title: Reduce malware threats via file attachment blocking
description: Describes how to use file type blocking and file name extension blocking for attachments in Exchange Online Protection. Doing this helps thwart malware attacks.
author: simonxjx
ms.author: v-six
manager: dcscontentpm
audience: ITPro
ms.topic: troubleshooting
ms.service: exchange-online
localization_priority: Normal
ms.custom: 
- Exchange Online
- CSSTroubleshoot
ms.reviewer: 
appliesto:
- Exchange Online
- Exchange Online Protection
search.appverid: MET150
---
# How to reduce malware threats through file attachment blocking in Exchange Online Protection

_Original KB number:_ &nbsp; 2959596

## Summary

Most malware that enters an environment through email does so through an executable payload that's attached to an email message.

To reduce your risk from malware that may not be detected by Exchange Online Protection, you should enable file type blocking and file name extension blocking. This article describes how to do this.

## Resolution

To create a rule to block attachments that contain executable content in Exchange Online Protection, follow these steps:

1. Sign in to the Exchange admin center.
2. Select **mail flow**, select **rules**, select **New** (:::image type="icon" source="media/how-to-reduce-malware-threats-via-file-attachment-blocking/plus-button.png" border="false":::), and then select **Create a new rule**.
3. In the **Name** box, specify a name for the rule, and then select **More options**.
4. Under **Apply this rule if**, point to **Any attachment**, and then select **has executable content** near the bottom of the page.
5. Under **Do the following**, point to **Block the message**, and then select the action that you want.
6. Select **save**.

The following is a screenshot of a sample rule.

:::image type="content" source="media/how-to-reduce-malware-threats-via-file-attachment-blocking/sample-rule.png" alt-text="Screenshot of the Exchange admin center showing an example rule.":::

The system automatically detects file types by inspecting file properties rather than the actual file name extension, thus helping to prevent malicious hackers from being able to bypass mail flow rule filtering by renaming a file extension. For more information, see [Use mail flow rules to inspect message attachments in Exchange Online](/exchange/security-and-compliance/mail-flow-rules/inspect-message-attachments).

## More information

Microsoft is continually updating its virus definition catalog based on [submissions](https://www.microsoft.com/wdsi/filesubmission). However, to provide customers with the most immediate and effective defense, a file filter block policy is critical.

For more information about malware defense practices and strategies, see the following Microsoft resources:

- [Configure anti-malware policies in EOP](/microsoft-365/security/office-365-security/configure-anti-malware-policies)
- [Anti-malware protection FAQ](/microsoft-365/security/office-365-security/anti-malware-protection-faq-eop)
- [Submitting malware and non-malware to Microsoft for analysis](/microsoft-365/security/office-365-security/submitting-malware-and-non-malware-to-microsoft-for-analysis)

Still need help? Go to [Microsoft Community](https://answers.microsoft.com/).
