---
title: Issues with outbound calls
description: Provides potential causes and resolutions for the issues with outbound calls when you use direct routing.
ms.date: 7/22/2021
author: cloud-writer
ms.author: meerak
manager: dcscontentpm
audience: Admin
ms.topic: troubleshooting
ms.service: msteams
localization_priority: Normal
search.appverid:
- SPO160
- MET150
appliesto:
- Microsoft Teams
ms.custom: 
- CI 126689
- CSSTroubleshoot 
ms.reviewer: mikebis
---

# Issues with outbound direct routing calls

You might experience various issues with outbound calls from a Teams client to a Session Border Controller (SBC) when you use Direct Routing. These include:

- Incorrect caller ID displayed to the call recipient.
- Connection to the SBC not established.
- Either a few or all users in a tenant are unable to make calls.

This article provides potential causes for these issues and resolutions that you can try.

## Incorrect caller ID displayed to the call recipient

When you use Direct Routing, the caller ID information is delivered to the call recipient via the `From` and `P-Asserted-Identity` headers in the SIP Invite message.

The `From` header contains any of the following information:

- The number assigned to the caller initiating the call.
- A service number that is assigned to the caller by using the `CsCallingLineIdentity` cmdlet.
- The number of the original caller if the call was forwarded.
- `anonymous@anonymous.invalid`, which indicates that the caller's number should be hidden from the call recipient.

The `P-Asserted-Identity` header contains the number of the user who is billed for the call. If `Privacy:id` is set, it indicates that the information in the header must be hidden from the call recipient.

### Cause

If the information in the `From` header and the `P-Asserted-Identity` header do not match, and the PSTN prioritizes to display the information in the `P-Asserted-Identity` header instead of the `From` header, then incorrect information is displayed.

### Resolution

To ensure that the correct caller ID is displayed to the call recipient, configure the SBC to manipulate the SIP Invite message to either remove the `P-Asserted-Identity` header or modify its contents.

## Connection to the SBC not established

Sometimes the calls reach the SBC but no connection is established. When the SBC receives a SIP Invite message from Teams, it sends a failure message back with error codes in the range 400 to 699.

There might be different reasons that prevent a connection to the SBC.

### Cause 1

The SIP failure message might be generated by another telephony device that is on the same network as the SBC.

### Resolution 1

Troubleshoot the device to fix the error. If you need assistance, contact the device's vendor.

### Cause 2

The SIP failure message is being sent by the Public Switched Telephone Network (PSTN) provider. This is most likely the case if the failure error code sent is either SIP 403 or SIP 404.

### Resolution 2

Contact your PSTN provider for help with fixing the issue.

### Resolution 3

If the issue is not caused by a different device on the network or your PSTN provider, contact the SBC's vendor for support to fix the issue.

## Some users are unable to make calls

If the connection between the Teams client and the SBC is working correctly but some users are not able to make calls, then the issue might be caused by incorrect settings or provisioning of those users.

### Cause 1

The users are missing the dial pad in the Teams calling tab.

### Resolution 1

Make sure that the user has the correct license (E3 with Phone System or E5) and all required settings. To check them, run the [`Get-CsOnlineUser`](/powershell/module/skype/get-csonlineuser) cmdlet in Teams PowerShell as follows:

```powershell
Get-CsOnlineUser -Identity <UserIdParameter> | fl Identity,EnterpriseVoiceEnabled,HostedVoiceMail,OnPremLineURI
```

All the required values must be configured as described in [Enable users for Direct Routing, voice, and voicemail](/microsoftteams/direct-routing-enable-users).

### Cause 2

None of the patterns in the Online Voice Routing policy (OVRP) match the number dialed by the user.

### Resolution 2

Make sure the following conditions are true:

- There is a pattern in the OVRP that matches the dialed number.
- The usage profile for the call matches the one set up for the specific user.
- The gateway specified for the SBC is enabled. If it is disabled, either enable it or select a different gateway that is enabled.

### Cause 3

There are invalid characters in the user's OVRP.

### Resolution 3

Invalid invisible characters can get into the OVRP when copying the information from Word or other WYSIWYG editors. They are not displayed but are taken into account when deciding the route that the call should take.

To fix the issue, remove the policy and add it again either by rewriting it manually or by copying and pasting from a non-WYSIWYG editor such as Notepad.

## No users are able to make calls

If none of the users are able to make calls, then the calls are probably not reaching the SBC. Check for one of the following causes.

### Cause 1

Teams might have a disabled gateway.

### Resolution 1

Use the Microsoft Teams admin center to make sure that the gateway being used by Teams is available or enable it, if disabled.

You can also use Teams PowerShell to check and update the gateway as required.

Run the [`Get-CsOnlinePSTNGateway`](/powershell/module/skype/get-csonlinepstngateway) cmdlet to check the status of the gateway. The output must show that the value of the `Enabled` parameter is set to `True`. In the following example, the `sbc1.contoso.com` gateway has the value of the `Enabled` parameter set to `True` but the `sbc2.contoso.com` gateway does not.  

```powershell
Get-CsOnlinePSTNGateway | fl Identity,Fqdn,SipSignalingPort,MaxConcurrentSessions,Enabled
```

:::image type="content" source="media/issues-with-outbound-calls/gateway-status-1.png" alt-text="Screenshot of gateway status":::

To ensure that the `sbc2.contoso.com` gateway is available to Teams, run the [`Set-CsOnlinePSTNGateway`](/powershell/module/skype/set-csonlinepstngateway) cmdlet to set the value of the `Enabled` parameter to `True`.

```powershell
Set-CsOnlinePSTNGateway -Identity "sbc2.contoso.com" -Enabled $true
```

To check whether the `sbc2.contoso.com` gateway is available now, run the `Get-CsOnlinePSTNGateway` cmdlet again:

```powershell
Get-CsOnlinePSTNGateway -Identity "sbc2.contoso.com" | fl Identity,Fqdn,SipSignalingPort,MaxConcurrentSessions,Enabled
```
:::image type="content" source="media/issues-with-outbound-calls/gateway-status-2.png" alt-text="Second screenshot of gateway status":::

For more information, see [Connect your SBC to Direct Routing](/microsoftteams/direct-routing-connect-the-sbc).

### Cause 2

The gateway is not responding to Session Initiation Protocol (SIP) messages because some device on the network, such as a firewall, is blocking the messages.

### Resolution 2

Make sure that the SIP Signaling IPs/FQDNs are allowed on all network devices that connect the SBC to the internet. The list of IP addresses that must be allowed are listed at [SIP Signaling: FQDNs](/microsoftteams/direct-routing-plan#sip-signaling-fqdns).

## More information

Still need help? Go to [Microsoft Community](https://answers.microsoft.com/).
