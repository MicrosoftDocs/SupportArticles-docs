---
title: Errors when running desktop flows including Excel actions
description: Provides mitigation steps for errors generated by Excel actions in desktop flows.
ms.author: iomavrid
author: yiannismavridis
ms.date: 07/16/2025
ms.custom: sap:Desktop flows\Office automation
---
# Errors when running desktop flows, including Excel actions

This article provides mitigation steps for errors generated by [Excel actions](/power-automate/desktop-flows/actions-reference/excel) in desktop flows. Most errors occur in the context of multiple Excel actions, and there's no strict mapping between them.

## More information

|Exception|Mitigation steps|
|---|---|
|System.ArgumentNullException: Value cannot be null.</br>Parameter name: type|When Excel fails to open with this error, make sure that Excel is installed, licensed, and properly configured on the computer. You can also try to repair your Office installation.|
|System.IO.FileNotFoundException: documentPathSafe|The Excel file doesn't exist, or its name or path isn't spelled correctly. Also, the file path shouldn't contain more than 255 characters.|
|System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Office.Interop.Excel' or one of its dependencies. The system cannot find the file specified.|Ensure you have Excel installed on the machine.|
|System.IO.IOException: The process cannot access the file 'C:\YourPath\YourFile.xlsx' because it is being used by another process.|The Excel application is locked, and no other process can access it. Terminate all opened Excel processes and restart Power Automate for desktop.|
|System.UnauthorizedAccessException: Access to the path 'C:\YourPath\YourFile.xlsx' is denied.|The document is located in a restricted file path, or Power Automate for desktop doesn't have permission to open and access the document. Move the file to a directory where Power Automate for desktop has access. |
|Microsoft.Flow.RPA.Desktop.Modules.SDK.ActionException: Excel document '<Excel_file_name>' not found.|Make sure that the Excel file is opened and its name or path is spelled correctly.|
|System.OutOfMemoryException: Out of memory|The Excel application crashes due to insufficient memory or high memory utilization caused by a specific extension running on Excel. Terminate all opened Excel applications and try again.|
|System.Runtime.InteropServices.COMException: Open method of Workbooks class failed|The Excel file path shouldn't contain more than 255 characters.|
|System.Runtime.InteropServices.COMException: The RPC server is unavailable. (Exception from HRESULT: 0x800706BA)|When an Excel file fails to open with this error, try to enable the **Nest under a New Excel process** option under the **Advanced** group of parameters. The existing Excel process might be terminated before opening this Excel file.|
|System.Runtime.InteropServices.COMException: Unknown name. (Exception from HRESULT: 0x80020006 (DISP_E_UNKNOWNNAME))|Make sure that the target Excel file is opened in Protected View.|
|System.Runtime.InteropServices.COMException: Call was rejected by callee. (Exception from HRESULT: 0x80010001 (RPC_E_CALL_REJECTED))|The target Excel file shouldn't be edited (for example, a cell is actively being edited at the time of the action run) or blocked by a pop-up dialog when the corresponding Excel action runs.|
|System.Runtime.InteropServices.COMException: Exception from HRESULT: 0x800A03EC|When you use an Excel action where a column, a row, or both need to be specified, the column index should be greater than zero and less than 16,385, or the column letter should belong to the range between A and XFD. Furthermore, the row index should be greater than zero and less than 1,048,577.|
|System.Runtime.InteropServices.COMException: The object invoked has disconnected from its clients. (Exception from HRESULT: 0x80010108 (RPC_E_DISCONNECTED))|The Excel instance should be open and active, so the Excel file shouldn't be closed manually or through the "Close Excel" action before the rest of the Excel actions take place.|
|System.Runtime.InteropServices.COMException: Retrieving the COM class factory for component with CLSID {ID} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).|This issue can occur if you're using an older version of Excel, such as Excel 2013 or earlier. Ensure you have Excel 2013 or a later version installed on your machine.|

### Exceptions with embedded mitigation steps

Some exceptions include mitigation steps in their error messages:

|Exception in error details|
|---|
|System.Runtime.InteropServices.COMException: The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet. You might be requested to enter a password.|
|System.Runtime.InteropServices.COMException: The file name is too long. Rename the file with fewer than 207 characters.|
|System.Runtime.InteropServices.COMException: The password you supplied isn't correct. Verify that the <kbd>Caps Lock</kbd> key is off and be sure to use the correct capitalization.|
|System.Runtime.InteropServices.COMException: Excel cannot open the file '<Excel_file_name>' because the file format or file extension is not valid. Verify that the file hasn't been corrupted and that the file extension matches the format of the file.|
|System.ArgumentOutOfRangeException: Specified argument was out of the range of valid values.</br>Parameter name: The column number must be greater than one or less than 16384.|

## Troubleshooting generic COMException (HRESULT: 0x800xxxxx) errors

When you try to open a blank or existing Excel file in Power Automate for desktop, you might receive an error similar to:

> System.Runtime.InteropServices.COMException: Exception from HRESULT: 0x800xxxxx

### Cause

This error might occur due to one or more of the following reasons:

- Office apps (or just Excel) aren't properly installed.
- Power Automate for desktop isn't properly installed.
- The Excel file is synchronized with OneDrive.

### Resolution

- Manually [uninstall](/power-automate/desktop-flows/install#uninstall-power-automate) and [reinstall](/power-automate/desktop-flows/install) Power Automate for desktop. If it doesn't work, ensure you have Excel properly installed.
- To work around the error caused by the synchronization with OneDrive, see [Using Excel files synchronized through OneDrive or SharePoint](/power-automate/desktop-flows/actions-reference/excel#using-excel-files-synchronized-through-onedrive-or-sharepoint).
