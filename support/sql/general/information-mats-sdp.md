---
title: Information about MATS and SDP
description: This article introduces the frequently asked questions about Microsoft Automated Troubleshooting Services and the Support Diagnostics Platform.
ms.date: 01/20/2021
ms.reviewer: kaushika
---
# Information about Microsoft Automated Troubleshooting Services and Support Diagnostic Platform

This article introduces the frequently asked questions (FAQ) about Microsoft Automated Troubleshooting Services (MATS) and the Support Diagnostics Platform (SDP).

_Original product version:_ &nbsp; Windows  
_Original KB number:_ &nbsp; 2598970

## Summary  

Microsoft Support uses MATS to collect diagnostic information from a Windows-based computer, to analyze the data that is collected for known root causes, and to determine the correct resolution to any issues found. The information that is collected may also be used to automatically perform common troubleshooting tasks or automatically fix known problems on your computer. The results of data that you collect can be uploaded to Microsoft support.

For troubleshooting, go to [troubleshooting](#troubleshooting) section of this document.

## Q1: How do I run the diagnostic packages?

- On computers that have an Internet connection:
  1. Click the URL that Microsoft has provided to you or copy the URL and paste it into the address bar of your web browser.
  2. When the page loads, click on the large "Run" button that is displayed in the page, and make sure that you select the "Run" (or "Open") dialog prompt when you are asked whether you want to run or save the file.
  3. You may be prompted with a User Account Control (UAC) dialog box that asks whether you want MATS to change your computer. Click the "Yes" button.
  4. Follow the instructions to run and then upload the data that is generated by the diagnostic.

- On computers that have no Internet connection: see Q2 in this article.

## Q2: How do I run SDP diagnostics on a computer that has no Internet connection?

1. On a computer that has an Internet connection:

   1. Click the URL that Microsoft has provided to you or paste the URL into the address bar of your web browser.
   2. When the page loads, click the large "Run" button, and make sure that you select the "Run" (or "Open") dialog prompt when you are asked whether you want to run or save the file.
   3. You may be prompted with a UAC dialog box that asks whether you want MATS to change your computer. Click the "Yes" button.
   4. After MATS starts, click the "Accept" button.
   5. Select "A different computer" and then click the "Next" button. Note: If the destination computer already has PowerShell installed or is a computer that has Windows 7 or Server 2008 R2, you can select the option "The computer already has Windows PowerShell installed" option by clicking the check box.
   6. Click the "Begin" button.
   7. Save the diagnostic on a USB drive or a network share. A file that is named "Portable_Diagnostic.exe" will be generated.
2. On the computer to be diagnosed:
   1. Run the "Portable_Diagnostic.exe" file (this is the file that was generated on the computer that has an Internet connection). The diagnostic starts.
   2. Click the "Accept" button and follow the instructions to run the diagnostic.
   3. After the diagnostic is finished, you are prompted to review and save the upload results. Save the diagnostic results on a USB drive or a network share. A subfolder starting with the words "Upload Results" will be created in the location that you selected to save the results.
3. On a computer that has an Internet connection:
   1. Locate the saved results within the Upload Results folder (from step "2c" earlier in this article) and run the "Upload_results.exe" file.
   2. Click the "Send" button to upload the results back to Microsoft Support.

## Q3: Can MATS/SDP diagnostics change my system configuration?

Some diagnostic packages that are running on MATS may change the configuration of the computer, and some may not. We recommend that you review the Knowledge Base article for the specific diagnostic package that you intend to run for the most accurate information about what the package may change and the information that it may collect. For example, diagnostics may enable debug-related logging and then require you to reproduce the problem that you are experiencing. Some of this logging may be enabled and maintained until the diagnostic package uploads the troubleshooting information to Microsoft Support.

MATS can also install run-time packages, such as Windows PowerShell, in order to run diagnostic packages. Not all configuration changes that are made by MATS will be reverted after the diagnostic package finishes. Specifically, if PowerShell is installed, PowerShell will not be automatically removed from the computer.

Additionally, some diagnostics can also detect specific problems. If diagnostics can automatically find and fix problems, you will be given the option to apply fixes. If you decide to apply the fixes, the changes that are made by that fix will remain after the diagnostic finishes.

## Q4: What operating systems can run Microsoft Support's diagnostic packages?

- Windows XP (x86 and x64)
- Windows Server 2003 (x86 and x64)
- Windows Vista (x86 and x64)
- Windows Server 2008 (x86 and x64)
- Windows 7 (x86 and x64)
- Windows Server 2008 R2 (x64)
- Windows 8 (x86 and x64)
- Windows Server 2012

## Q5: Are there any installation environments that are not supported and therefore cannot run diagnostic packages?

Newer diagnostic packages cannot run on:

- Itanium (IA-64)
- Windows Server 2008 (non-R2) Server Core installation option

If the destination computer runs either of these environments, you may be able to run an older reduced functionality diagnostic package if available. Please see Q7 for additional details.

If a reduced functionality package is not available on the diagnostic webpage, you may ask your support engineer to send you a reduced functionality diagnostic package that is compatible with Itanium (IA-64) or Windows Server 2008 Server Core installation option.

## Q6: Are there any prerequisites for running the diagnostic package?

There are different prerequisites for running diagnostic packages, depending on the operating system of the destination computer. The diagnostic will automatically check your computer for these prerequisites and start executing if they are already installed or prompt you to install them if they are not already available on the computer.

> [!NOTE]
> Certain diagnostic packages may also require PowerShell 2.0 which is not automatically installed by MATS. You can download PowerShell 2.0 by using the links provided in this article. Also, a diagnostic package may have other troubleshooting-specific prerequisites. For example, a diagnostic package that is designed to troubleshoot Exchange Server components may require that Exchange Server be installed on the computer.

### Minimum requirements to run a diagnostic on the following operating systems

#### Windows XP or Windows Server 2003

- Windows XP (32-bit) requires Service Pack 3 or a later version
- Windows XP 64-bit and Windows Server 2003 both require Service Pack 2 or a later version
- Microsoft Core XML Services (MSXML) 6.0
- The .NET Framework 2.0, 3.0 or 3.5 (Installing .NET Framework 4.0 or later version does not install the needed configuration for these versions of Windows)
- Windows PowerShell 1.0 or 2.0 (Windows PowerShell 2.0 is part of Windows Management Framework)

    > [!NOTE]
    > The diagnostic will automatically install PowerShell 1.0 for you. However, if 2.0 is needed, you must manually install it yourself.

#### Windows Vista or Windows Server 2008

Windows PowerShell 1.0 or 2.0 (Windows PowerShell 2.0 is part of Windows Management Framework)

> [!NOTE]
> The diagnostic will automatically install PowerShell 1.0 for you. However, if 2.0 is needed, you must manually install it yourself.

#### Windows 7 or Windows Server 2008 R2

All minimum requirements are met.

#### Windows 8 or Windows Server 2012

All minimum requirements are met.

> [!NOTE]
> Some diagnostic packages on Windows 8 may require installation of .NET Framework 3.5.1 - on which installation will be started automatically the first time that the diagnostic package runs.

### Download locations for the minimum requirements

- The .NET Framework (Select this link to install if .NET Framework 3.5 is not already on the computer that you want to run the diagnostic package on): [Microsoft .NET Framework 3.5 Service pack 1 (Full Package)](https://www.microsoft.com/download/en/details.aspx?id=25150)
- Microsoft Core XML Services (MSXML) 6.0
- [Windows PowerShell System Requirements](/powershell/scripting/windows-powershell/install/windows-powershell-system-requirements)

### Restart Requirements

Usually there are no restart requirements for installing the minimum prerequisites. However, there will be some situations in which a restart will be necessary. For example, your computer has PowerShell 1.0 installed and you upgrade to PowerShell to 2.0, or your computer has installed an update recently and a restart is pending.

## Q7: What should I do if PowerShell cannot be installed on the computer to be diagnosed?

If the destination computer is running Windows XP, Windows Server 2003, Windows Vista, or Windows Server 2008 and you cannot install PowerShell, you may be able to run a reduced functionality version of the diagnostic package. However, there may not be an equivalent "Reduced Functionality" package available for every diagnostic. In addition, reduced functionality packages may not collect the full set of data that is collected by a standard package (it may only be able to collect a subset).

In order to determine whether you can run a reduced functionality package that does not require installation of the minimum prerequisites listed in Q6, open the URL that was provided by Microsoft in the email message and expand the "Additional methods to run this diagnostic package" section. If you see the text labeled "On Windows XP, Windows Server 2003, Windows Vista, or Windows Server 2008," this means that a reduced functionality version of the package can be run on the computer. In this case, you can expand the section and then click the "Run diagnostic" link. The following article contains more information about how to run reduced functionality packages:

[Frequently asked questions about the Microsoft Support Diagnostic Tool (MSDT)](https://support.microsoft.com/help/926079)

## Q8: Which components and files remain on the computer after MATS uploads the files to Microsoft?

As described in Q3, some settings, or run-time components may remain on the computer. For example, if PowerShell was installed during the execution of a diagnostic package, PowerShell will remain on the computer.

During data collection, MATS diagnostic information is stored temporarily in the folder `%WINDIR%\TEMP\SDIAG_{GUID}` (where GUID is a randomly generated GUID that represents a unique diagnostic execution instance), `%TEMP%\msdtadmin and/or %APPDATA%\..\Local\ElevatedDiagnostics\{Folder}`. These folders are deleted after the diagnostic package has finished running.

## Q9: Can diagnostic packages change the PowerShell execution policy?

Most of the diagnostic packages do not make any changes to the PowerShell execution policy. However, some diagnostic packages that collect information from remote computers may alter the PowerShell execution policy to "RemoteSigned" temporarily.

The diagnostic package will change the configuration back to the original policy before it finishes collecting the information. Be aware that the policy may remain "RemoteSigned" if you cancel the diagnostic before the package finishes running.

## Q10: How do you start a diagnostic package on a Server Core installation of Windows Server 2008 R2?

Windows Server 2008 R2 Server Core does not support running diagnostic packages directly on the computer. In order to diagnose a Windows Server 2008 R2 Server Core computer, you will have to contact your support engineer and request a passkey to run a specific diagnostic package that can be used to collect information from a Server Core R2 computer by using a remote computer.

## Q11: Why does the "Refreshing System Information..." window appear when you run certain diagnostic packages?

This message is generated by the "System Information" utility (MSInfo32) when it is collecting information about the computer. A diagnostic package usually runs the msinfo32 utility in the background, while executing other diagnostic tasks in the foreground, to speed up the data collection process. This process only collects information about the system and does not update any settings on the computer.

## Q12: How do I run diagnostics on a Windows Server-based computer that has Internet Explorer Enhanced Security Configuration (IESC) enabled?

You have two options:

1. Generate a Portable Executable file on a server that has "Internet Explorer Enhanced Security Configuration" disabled or on a computer that is running a client operating system, such as Windows Vista or Windows 7. Then, run the portable executable on the target computer. See Q2 for more information about how to generate a portable executable.
2. Add [Welcome to Microsoft Support](https://support.microsoft.com) site to the list of trusted sites

## Q13: Which URLs must be configured on a firewall/ proxy in order to run a diagnostic package?

The following URLs are accessed when you run a diagnostic package:

- `http://support.microsoft.com`
- `https://support.microsoft.com`
- `https://dcupload.microsoft.com`
- `https://dcodews.partners.extranet.microsoft.com`
- `http://microsoft.com`
- `https://microsoft.com`

## Q14: My environment is complex. How do I choose which computers to run the diagnostic on?

If you are not sure as to which computers to run the diagnostic packages on, please discuss the issue further with a Microsoft support engineer.

## Q15: How does Microsoft Support use the information uploaded by a diagnostic package?

The data that is uploaded by a diagnostic package is used for troubleshooting. We will not disclose any information that is included in the results outside of Microsoft, its controlled subsidiaries, and its affiliates without your consent.

Microsoft is committed to protecting the security of your personal information. We use many different security technologies and procedures to help protect your personal information from unauthorized access, use, or disclosure. For example, we store the personal information that we collect on computer systems with limited access, which are located in controlled facilities. When we transmit highly confidential information over the Internet, we protect it by using encryption, such as the Secure Socket Layer (SSL) protocol.

Read the Microsoft Online Privacy Statement additional information on Microsoft's commitment to protecting your privacy: [Microsoft Privacy Statement](https://www.microsoft.com/privacy).

## Troubleshooting

This section discusses the most common problems that may occur when you run diagnostic packages on a computer.

## T1: When you run a diagnostic, the "This computer" option is dimmed and the diagnostic cannot be run

This may occur because the diagnostic package that you are trying to run is incompatible with the operating system of the destination computer. For example, you may be running Windows XP but the diagnostic package that Microsoft Support has sent you is only compatible with Windows 7. In this case, please contact a Microsoft Support professional to ask for a diagnostic that is compatible with the operating system of the destination computer.

## T2: When you run a diagnostic package, you receive a "We were unable to download the necessary components from our server. Try again later" error message, and the application closes

### Fix it for me

To check for connections to URLs used in SDP Service, click the **Fix it** button or link. Then click **Run** in the **File Download** dialog box, and follow the steps in the Fix it wizard.  

> [!NOTE]
> - The Fix it package is only compatible with Windows 7 and later versions. The package will be updated to support earlier versions of Windows soon.
> - This wizard may be in English only. However, the automatic fix also works for other language versions of Windows.
> - If you are not on the computer that has the problem, save the Fix it solution to a flash drive or a CD and then run it on the computer that has the problem.

### Let me fix it myself

This usually happens when the computer cannot contact Microsoft servers to download client components or the diagnostic package. Verify that your browser can access the sites that are listed in Q13 that was discussed earlier.

As a workaround, you can use another Internet-connected computer to generate a portable diagnostic package as described in Q2, or ask a Microsoft support engineer to generate a portable executable and send it to you to run on the target computer.

## T3: When transferring files to Microsoft Support, you receive a "The application was unable to contact the diagnostic server. Make sure that you are connected to the Internet, then try again" error message

This error occurs when the computer that is used to transfer results to Microsoft Support cannot reach Microsoft servers, or if communication with the servers is interrupted or times out. If the problem persists after you click the "Retry" button, you can troubleshoot this issue further by following these steps:

1. Run the steps described in T2 to troubleshoot this problem.
2. Verify that your browser can access the sites that are listed in Q13.
3. f you still cannot upload the results to Microsoft Support after you follow the previous steps, and you have saved a copy of the results CAB file, please contact Microsoft Support to arrange transfer of the CAB file.
4. If you have not saved a copy of the results you start the file transfer, you may be able to obtain it if the diagnostic is still running. The file will be stored in either the `%TEMP%\msdtadmin\_{GUID}_` or `\Windows\Temp\SDIAG_{GUID}` folders (where GUID is a randomly generated identifier representing a diagnostic execution instance).

## T4: When you run the portable diagnostic package ("Portable_Diagnostic.exe"), you receive a "This application is not supported on this Operating System" or a "This diagnostic tool does not support your computer's configuration" error message and the application closes

This may occur because the portable diagnostic package that you are trying to run is incompatible with the operating system of the destination computer. For example, you may be running Windows XP but the diagnostic package that Microsoft Support has sent to you is only compatible with Windows 7. In this case, please contact a Microsoft Support professional to ask for a diagnostic that is compatible with the operating system of the destination computer.

## T5: When you run a diagnostic, you receive a "This troubleshooter doesn't apply to this computer" (error 0x80005005) or a "This troubleshooter doesn't apply to your system" error message, and the application closes

This may occur because the diagnostic package that you are trying to run is incompatible with the operating system of the destination computer. For example, you may be running Windows XP but the diagnostic package that Microsoft Support has sent to you is only compatible with Windows 7. In this case, please contact a Microsoft Support professional to ask for a diagnostic that is compatible with the operating system of the destination computer.

## T6: When you run a diagnostic, you receive an "We are sorry but your passkey for this diagnostic tool is outdated or has expired" error message, and you cannot run the diagnostic

This error may occur because the URL sent by Microsoft has either expired or you reached the maximum number of uploads allowed by a diagnostic execution. In this case, you must contact Microsoft Support to ask to extend the expiration date or for a new URL.

## T7: When you run a diagnostic, you receive a "We're sorry, but the program encountered an error trying to contact the server. Try again later. [Code 80072EE7]" error message

This usually occurs when the computer cannot contact Microsoft servers to download client components or the diagnostic package. Run the Fix It troubleshooter available in T2 or verify that your browser can access the sites that were listed in Q13.

As a workaround, you can use another Internet-connected computer to generate a portable diagnostic package as described in Q2. Or, ask a Microsoft support engineer to generate a portable executable and send it to you to run on the target computer.

## T8: When you run a diagnostic, you receive a "The results files are too large to be sent to Microsoft..." error message

This error occurs when the data that the diagnostic collects results in a compressed file that is larger than 2 Gb. The diagnostic results CAB file can only be generated and uploaded automatically if it is less than 2 Gb.

When this error occurs, you can obtain the expanded version of the results and send them manually to a Microsoft support engineer. In order to do this, before you click "Close" on the diagnostic screen, open the `%windir%\temp\SDIAG_{GUID}\Result` (where GUID is a random identifier representing a unique diagnostic execution instance) folder, and then copy and compress the results to a different folder. After you copy the folder contents, return to the diagnostic and then click "Close" to clean up the temporary folder. Finally, contact your support professional to arrange for transfer of the files to Microsoft.

## T9: When you run a diagnostic on a Windows XP or Windows Server 2003 computer, you receive an "Unable to find a version of the run-time to run this application" error message

This error can occur if the computer has the .NET Framework 4.0 installed, but the .NET Framework 2.0 or the .NET Framework 3.5 is not installed. In order to fix the problem, please install the .NET Framework 2.0 or the .NET Framework 3.5 on the computer. You can find the installation links for the .NET Framework in Q6.

## T10: After You click the "Run" button to run a diagnostic on a Windows Server computer, you receive a "Your current security settings do not allow this file to be downloaded" error message, and the diagnostic does not run

This error can occur if the computer has Internet Explorer Enhanced Security Configuration enabled. Follow the instructions in Q12 to run diagnostic on a computer that has Internet Explorer Enhanced Security Configuration enabled.

## T11: When You Click the "Run" button to run a diagnostic on a Windows Server-based computer, only the "Save" and "Cancel" options are available

This issue may occur if the "Do not save encrypted pages to disk" option is set in Internet Options. When "Internet Explorer Enhanced Security Configuration" is enabled on a Windows Server-based computer, this option is automatically set.

In order to run a diagnostic on a computer with this option enabled, save the file and then run the diagnostic from the download folder. To disable the option, open "Internet Settings", select the "Advanced" tab, and then clear the "Do not save encrypted pages to disk" check box under "Security."

## T12: When You Click the "Run" button to run a diagnostic, you receive a "We're sorry, but an error occurred: Cookies are either not enabled in your browser or have been deleted" error message

This issue may occur if cookies are disabled in the browser. To resolve this issue, please enable cookies in your browser and refresh the page. To enable cookies in Internet Explorer, go to "Internet Options," select the "Privacy" tab, and then select "Default" under "Settings" to move the slider to the "Medium" setting.

Another possible reason for this error is that "Enhanced Security Configuration" is enabled on a Windows Server-based computer but not all sites that are listed in Q12 were added to the list of security sites. In order to resolve this issue, please follow the instructions in Q12. Alternatively you can also run the Fix It troubleshooter available in T2 to quickly identify "Enhanced Security Configuration" problems.
