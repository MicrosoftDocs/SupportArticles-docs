---
title: Troubleshooting and diagnostic tools for on-premises and hybrid scenarios
description: This article describes which tools Microsoft technical support uses for troubleshooting SQL Server hybrid issues.
ms.author: jopilov
ms.reviewer: jopilov
ms.date: 06/15/2023
ms.custom: sap:SQL Server Management, Query and Data Tools
author: PiJoCoder
---
# Troubleshooting and diagnostic tools for SQL Server on-premises and hybrid scenarios

_Applies to:_ SQL Server

## Introduction

Microsoft Product support for SQL Server hybrid uses troubleshooting tools to help customers collect logs and narrow down technical issues. These tools are available to use publicly. This article summarizes the diagnostic tools that SQL Server product support engineers have been using. The article details various troubleshooting scenarios and shows the corresponding log collection and log analysis tools.

## Diagnostic tools for SQL Server

| Scenario | Basic logs to collect | Tools to gather logs | Tools to analyze logs |
| --- | --- | --- | --- |
| Availability Group | - Cluster logs<br/>- Event logs<br/>- System Monitor (Performance monitor logs)<br/>- SQL Server error logs<br/>- SQLDIAG XEL files<br/>- AlwaysOn Health session XEL files<br/>- System Health session XEL files<br/>- Extended Events for AG data movement<br/>- DMV and Catalog view snapshots for AG |- Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use [scenario](https://github.com/microsoft/sql_logscout#scenarios) "AlwaysOn."<br/><br/>- Alternative: **[TSSv2](../../windows-client/windows-troubleshooters/introduction-to-troubleshootingscript-toolset-tssv2.md)**<br/>Use scenario "SQL Base."<br/><br/>- Alternative: **[PSSDIAG](https://github.com/microsoft/DiagManager/wiki/Create-a-PSSDiag-Package)**<br/>Use custom diagnostic "Always On Basic Info."<br/> | - Preferred: **[AGDiag](https://github.com/microsoft/agdiag/wiki/Getting-Started)**<br/>Scenarios to use: Analyze failover and failures.<br/><br/>- Alternative: **[SQL Nexus](https://github.com/microsoft/SqlNexus/wiki/How-to-use-SQL-Nexus)**<br/>Scenarios to use: performance, latency, health, and best practices.<br/> |
| Slow performance |<br/>- Extended Event (XEvent) trace captures batch-level starting/completed events, errors and warnings, log growth/shrink, lock escalation and timeout, deadlock, login/logout<br/>- List of actively running SQL traces and Xevents<br/>- Snapshots of SQL DMVs that track waits/blocking and high CPU queries<br/>- Query Data Store info (if that is active)<br/>- `tempdb` contention info from SQL DMVs/system views<br/>- Linked Server metadata (SQL DMVs/system views)<br/>- Service Broker configuration information (SQL DMVs/system views) | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use [scenarios](https://github.com/microsoft/sql_logscout#scenarios) "GeneralPerf," "DetailedPerf," or "LightPerf."<br/><br/><br/>- Alternative: **[PSSDIAG](https://github.com/microsoft/DiagManager/wiki/Create-a-PSSDiag-Package)**<br/>Use scenarios "General Performance," "Detailed Performance," or "Light Performance." | - Preferred: **[SQL Nexus](https://github.com/microsoft/SqlNexus/wiki/How-to-use-SQL-Nexus)**<br/>Scenarios to use: performance analysis, best practice recommendations, bottleneck analysis, blocking, and top queries.<br/><br/>- Alternative: **[RML Utilities](replay-markup-language-utility.md)**<br/>Scenarios to use: query analysis to understand top resource consuming queries.<br/> |
| Connection | - BID Trace/Driver Traces<br/>- Network Trace<br/>- Auth Trace<br/>- SQL Server Error logs<br/>- Windows Event logs<br/>Snapshots of NETSTAT and TASKLIST |- Preferred: **[SQL Trace](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SQLTRACE)**<br/>Configure collection settings in the INI file.<br/><br/>- Alternative: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use [scenario](https://github.com/microsoft/sql_logscout#scenarios) "NetworkTrace."<br/><br/>- Alternative: **[SSPICLIENT](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SSPICLIENT)**<br/>Use this tool when encountering SSPI or Kerberos errors and log a detailed trace for analysis.<br/> | - Preferred: **[SQL Network Analyzer UI](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SQLNAUI)**<br/>**[SQL Network Analyzer](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SQLNA)**<br/>Scenarios to use: Read network packet capture files and produce a report highlighting potential areas of interest.<br/><br/>- Alternative: **[SQLCHECK](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SQLCHECK)**<br/>Reports on any settings that may affect connectivity.<br/><br/>- Alternative: **[SQLBENCH](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/SQLBENCH)**<br/>Display timings for comparative analysis.<br/><br/>- Alternative: **[DBTEST](https://github.com/microsoft/CSS_SQL_Networking_Tools/wiki/DBTEST)**<br/>Record how long it takes to connect and how long to execute a command.<br/> |
| Replication | - SQL Server error logs<br/>- Replication, CDC, CT diagnostic info (SQL DMVs/system views) | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use data collection [scenario](https://github.com/microsoft/sql_logscout#scenarios)<br/>"Replication."<br/><br/><br/>- Alternative: **[PSSDIAG](https://github.com/microsoft/DiagManager/wiki/Create-a-PSSDiag-Package)**<br/>Use custom diagnostic "Replication."<br/> | - Preferred: **[SQL Nexus](https://github.com/microsoft/SqlNexus/wiki/How-to-use-SQL-Nexus)**<br/>Scenarios to use: replication reports, performance analysis, best practice recommendations, bottleneck analysis, blocking, and top queries.<br/> |
| Installation/Setup | - Setup Bootstrap folder with all the setup logs | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use data collection [scenario](https://github.com/microsoft/sql_logscout#scenarios) "Setup." | |
| Backup/Restore | - Backup/Restore progress Xevent ([backup_restore_progress_trace](/sql/relational-databases/backup-restore/back-up-and-restore-of-sql-server-databases#monitor-progress-with-xevent))<br/>- Trace flags for backup restore progress<br/>- SQL VSS Writer Log (on SQL Server 2019 and later versions)<br/>- VSS Admin (OS) logs for VSS backup-related scenarios<br/>- Performance Monitor | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use data collection [scenario](https://github.com/microsoft/sql_logscout#scenarios) "BackupRestore." | |
| Memory usage  | - Memory clerks DMVs or [DBCC MEMORYSTATUS](../database-engine/performance/dbcc-memorystatus-monitor-memory-usage.md)<br/>- Performance Monitor | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use data collection [scenario](https://github.com/microsoft/sql_logscout#scenarios) "Memory." | - Preferred: **[SQL Nexus](https://github.com/microsoft/SqlNexus/wiki/How-to-use-SQL-Nexus)**<br/> Scenarios to useï¼šimport memory output and view at Memory Brokers.|
| Memory dumps | - Manual memory dumps captured for specific t-shooting scenarios<br/>- Automatically generated memory dumps for exception scenarios | - Preferred: **[SQL LogScout](https://github.com/microsoft/SQL_LogScout/releases)**<br/>Use data collection [scenario](https://github.com/microsoft/sql_logscout#scenarios) "DumpMemory."<br/><br/>- Alternative: **[SQLDumper](use-sqldumper-generate-dump-file.md)**<br/><br/>- Alternative: **[TSS V2](../../windows-client/windows-troubleshooters/introduction-to-troubleshootingscript-toolset-tssv2.md)**<br/>Use scenario "SQL Base" to gather existing memory dumps.<br/> |- Preferred: **[WinDbg (Debugging tools for Windows)](/windows-hardware/drivers/debugger/debugger-download-tools)**<br/> Scenarios to use: [load and analyze](/windows-hardware/drivers/debugger/getting-started-with-windbg) memory dump. <br/><br/>- Alternative: **[SQL CallStack Resolver](https://github.com/microsoft/SQLCallStackResolver)** |
| Database corruption | SQL I/O pattern stress simulation   |  **[SQLIOSim](sqliosim-utility-simulate-activity-disk-subsystem.md)** | |
