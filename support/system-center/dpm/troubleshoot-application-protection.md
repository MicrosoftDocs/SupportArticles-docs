---
title: Troubleshoot application protection in DPM
description: Describes how to troubleshoot issues that may occur in application protection in Data Protection Manager.
ms.date: 04/08/2024
ms.reviewer: mjacquet, jarrettr
---
# Troubleshoot application protection in System Center Data Protection Manager

This article describes how to troubleshoot issues that may occur in application protection in Data Protection Manager (DPM).

_Original product version:_ &nbsp; System Center 2012 R2 Data Protection Manager, System Center 2012 Data Protection Manager  
_Original KB number:_ &nbsp; 4457488

## Microsoft SQL Server

|Issue|Possible cause|Resolution|
|---|---|---|
| DPM calculates space requirements incorrectly.| The database that you are protecting contains a SQL FILESTREAM.| DPM only considers the size of the .mdf and .ldf files when calculating space requirements for a database. |
| The DPM server stops responding when performing backup and consistency checks of databases on clusters.| There are a large number (more than 500) database files in a database on the SQL Server cluster.| Protecting SQL Server clusters that have many database files in a database affects the performance of the DPM server. You have to wait for DPM to complete the process. |
| Scheduled SQL Server protection jobs don't start.| Resources on the protected computer are unavailable, so SQL Server agent is unable to start.| Restart the computer. |
| DPM is unable to protect a SQL Server database.| You must have the required software installed to protect a computer that is running SQL Server.| The following versions of SQL Server must be installed on the instance of SQL Server that's hosting the database that you want to protect: <ul><li>SQL Server 2000 with Service Pack 4 (SP4)</li><li>SQL Server 2005 with Service Pack 2 (SP2)</li></ul><br/> **Note** DPM supports Standard, Enterprise, Workgroup, and Express Editions of SQL Server.<br/><br/> **Important** You must start the SQL Server VSS Writer Service on the SQL Server. By default, the SQL Server VSS Writer Service is turned off when you install SQL Server 2005.<br/><br/> **To start the SQL Server VSS Writer Service** <br/><br/>1. Select **Start**, point to **Administrative Tools**, and then select **Services**. <br/>2. On the **Services** screen, scroll down, right-click **SQL Server VSS writer**, and then select **Start**. <br/><br/> **Caution** After you start the SQL Server VSS Writer Service, we recommend that you don't stop the service. If your backups begin to fail, make sure that the SQL Server VSS Writer Service is started. |
| The SQL Server VSS Writer service fails during protection.| If you are protecting SQL Server 2005 on a Windows Server 2008 operating system, you must install SQL Server 2005 SP2.| For information about how to run editions of SQL Server on Windows Server 2008, see [Using SQL Server in Windows 8 and later versions of Windows operating system](https://support.microsoft.com/help/2681562). |
| SQL Server database backup fails.| If you delete one of the database files from the SQL Server but don't remove it from the database, the SQL Server VSS Writer Service will continue to report the deleted file, and DPM will be unable to locate it when it backups are performed.| Delete the database log files by using the following query: <br/><br/>`ALTER DATABASE <file name>.mdf`<br/><br/>`REMOVE FILE <file name>_log.ldf` <br/><br/>**Note** You will be unable to restore to the original location from the backups that existed before you deleted the log files because the file doesn't exist. To resolve this issue, you must restore the database files and then attach the database to the instance of SQL Server. |
| When you run an inquiry job in the DPM New Protection Group Wizard, such as viewing a list of data sources, if other instances SQL Server VSS Writers are enumerating the same data source, the DPM server will crash.| This can occur in the following scenario, where you have two SQL Server VSS writers, SqlServerWriter and MSDEWriter. <ul><li>You install an instance of SQL Server 2005. (By default, the SQL Server VSS Writer Service is turned off.)</li><li>Because the SQL Server VSS Writer Service is turned off, the MSDEWriter writer enumerates the SQL Server 2005 databases.</li><li>You turn on the SQL Server VSS Writer Service in the Service Control Manager. This sets the `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS\Settings\MSDEVersionChecking` registry sub key value to **1**. </li><li>After the registry key value is set to **1**, the `MSDEWriter` writer stops enumerating the SQL Server 2005 databases, and the `SQLServerWriter` writer starts enumerating them. </li></ul> <br/>Then you set the value of the registry key to zero (**0**). This causes both the `MSDEwriter` and `SQLServerWriter` writers to start enumerating the SQL Server 2005 databases.| To resolve this issue, you must set the value of the `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS\Settings\MSDEVersionChecking` registry key to **1** (a nonzero value) so that the `MSDEWriter` is the only writer that enumerates the SQL Server 2005 databases. |
| Database protection on an instance of SQL Server 2005 fails.| If you are protecting a database on an instance of SQL Server 2000 and you upgrade to SQL Server 2005, database protection on the instance of SQL Server 2005 will fail.| After you upgrade to SQL Server 2005 and then restart the SQL Server VSS Writer service, DPM will not map the existing replica to the protected database, because the new VSS writer enumerates the new database. Therefore DPM recognizes it as a new data source.<br/><br/>If this issue occurs, we recommend that you stop protection for the database that is hosted on the upgraded instance of SQL Server 2005, and then use the **Create New Protection Wizard** to reconfigure protection.<br/><br/> **Note** After you reconfigure protection, DPM Administrator Console displays the protected database as two separate nodes. The protection status in the Protection task area is displayed as an inactive replica for one of the database nodes, and the DPM Recovery UI displays two database nodes that have the same name. No data loss occurs for this issue. |
| SQL Server 2000 database replica creation job fails running on a 64-bit computer.| Replica creation jobs may fail on a SQL Server 2000 database that's running on a 64-bit computer in Windows in Windows (WOW) mode.| If a replica creation job fails on a SQL Server 2000 database that is running on a 64-bit computer in Windows (WOW) mode, check the Event Viewer on the SQL Server for Event ID 20 **Volume Shadow Copy Service error**.<br/><br/> |
| SQL Server full transaction log causes synchronization job failures.| If the database transaction log unexpectedly becomes full on a computer that is running SQL Server, synchronization jobs start to fail.| For information about how to resolve this problem, see [Troubleshoot a Full Transaction Log (SQL Server Error 9002)](/sql/relational-databases/logs/troubleshoot-a-full-transaction-log-sql-server-error-9002).|
| DPM protection jobs start to fail.| If DPM is protecting a SQL Server database that is using mirroring or log shipping, after a failover the protected primary database will no longer be online and your DPM protection jobs start to fail.| If you plan to fail-back to the primary database, do the following: <ul><li>After your protection jobs start to fail and the replica is no longer valid, run a consistency check.<br/> **Note** If you fail-back to the primary database after only a short period of time and the replica remains valid, you don't have to run a consistency check. </li><li>If there is a delay in the fail-back to the primary database, you must create a protection group by using the **New Protection Group Wizard** to protect the new active database.<br/>After the failover, you can stop protection on the new protection group.</li></ul><br/>If you don't plan to fail-back to the primary database, we recommend that you remove the database from protection and then configure protection for the new database. To remove the primary database, do the following: <ol><li>In DPM Administrator Console, select **Protection** on the navigation bar. </li><li>In the **Protection** task area, select the database that you want to remove, and then in the **Actions** pane, select **Remove from protection**. </li><li>In the **Stop Protection - \<Protection Group name>** dialog box, select the **Retain Protected Data** option, and then select **Stop Protection**. </li></ol>After you remove the primary database, configure protection for the new database by using the **New Protection Group Wizard**. |
| Incremental synchronizations fail for the SQL Server master database.| DPM doesn't support configuring incremental synchronizations for SQL Server master databases.| DPM allows for log backups for databases that are configured to use the full and bulk-logged recovery models. However, log backups cannot run against the SQL Server master database.<br/><br/>Additionally, don't set the synchronization frequency for the master database to **Just before a recovery point** because there are no backup logs to get from the protected server during the recovery. |
| DPM isn't protecting SQL Server 2005 databases.| SQL Server 2005 includes database snapshots that appear in the **New Protection Group Wizard** as regular databases. However, DPM does not support protecting database snapshots for recovery.| You can view database snapshots in the Microsoft SQL Server Management Studio in the Database Snapshots folder. |
  
## Hyper-V server

|Issue| Possible cause| Resolution|
|---|---|---|
| Backups fail for replica virtual machines.| Other jobs may be in progress.| Make sure that there are no conflicting jobs when the backup occurs. |
| Hyper-V virtual machine backups are not working.| You may have **iSCSI target storage provider** enabled on the protected computer.| Add the following sub key to the registry: <br/><br/> `HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft Data Protection Manager\Agent\UseSystemSoftwareProvider` |
| Migrating a virtual machine by using remote storage from a stand-alone back end to a CSV back end will cause Consistency Check to fail with an **Access Denied** message.|| Data Protection Manager runs a nightly job that updates the data source information. Run a manual Consistency Check to resolve this issue. |
| DPM error: DPM failed to synchronize changes for Microsoft Hyper-V \Backup Using Child Partition Snapshot\\\<VM Name> on \<Resource Group> because the snapshot volume didn't have sufficient storage space to hold the churn on the protected computer (ID 30115 Details: Unknown error (0x8004231f) (0x8004231F))| There is insufficient storage in the snapshot pool.| Verify that the SAN has enough available storage to create hardware snapshots. |
| DPM error: The VSS application writer or the VSS provider is in a bad state. Either it was already in a bad state or it entered a bad state during the current operation. (ID 30111 Details: Unknown error (0x800423f4) (0x800423F4))<br/><br/>VMMS event: No snapshots to revert were found for virtual machine 'CSVVM02'. (Virtual machine ID 4774EF60-F4B6-47D6-A0B9-60452C6B7FE8)| Automounting of volumes might not be enabled on the protected computer.| Enable automounting by using the following command: <br/><br/>`Mountvol /E` |
| DPM error: The VSS application writer or the VSS provider is in a bad state. Either it was already in a bad state or it entered a bad state during the current operation. (ID 30111 Details: Unknown error (0x80042306) (0x80042306))| The hardware provider vetoed snapshot creation.| This likely a configuration issue. Check the application event logs for VSS hardware provider events and validate the storage configuration with your SAN vendor. |
| The operation failed for Microsoft Hyper-V \Backup Using Child Partition Snapshot\Win7.01 on Win7.01.dpmcsv1.DC505.LAB because the data source isn't available. (ID 30169 Details: Unknown error (0x80042308) (0x80042308))| Live migration caused the virtual machine to move to another node while the backup was in progress.<br/><br/>Cluster disks are in a bad state.<br/><br/>Data source was deleted.|<br/>1. Rerun the backup job. <br/>2. Diagnose the storage volume for the virtual machine.  <br/><br/>For information about how to back up virtual machines on CSV, in the DPM 2010 Operations Guide, see [Considerations for Backing Up Virtual Machines on CSV with the System VSS Provider](/previous-versions/system-center/data-protection-manager-2010/ff634192(v=technet.10)?redirectedfrom=MSDN). |
| DPM error: Failed to prepare a Cluster Shared Volume (CSV) for backup as another backup using the same CSV is in progress. (ID 32612 Details: Unknown error (0x8007173d) (0x8007173D))| Too many parallel backups are competing for the same CSV LUN.| For information about how to enforce serial backups, in the DPM 2010 Operations Guide, see [Considerations for Backing Up Virtual Machines on CSV with the System VSS Provider](/previous-versions/system-center/data-protection-manager-2010/ff634192(v=technet.10)?redirectedfrom=MSDN). |
| DPM error: An unexpected error occurred during job execution. (ID 104 Details: Element not found (0x80070490))| There might be a failed disk in the cluster.| Repair or remove the failed disk in the cluster. |
| Backup of Hyper-V virtual machines are stalled and no data transfer occurs.| TCP Chimney Offloading may be active.| Run `netsh int tcp set global chimney=disabled` to disable TCP Chimney Offloading. |
  
## Windows servers

|Issue|Possible cause|Resolution|
|---|---|---|
| When you use WSB, the following errors might occur: <ul><li>DPM has detected a discontinuity in the log chain for \<DatasourceType> \<DatasourceName> on \<ServerName> since the last synchronization.</li><li>The recovery to the latest point in time failed. During a recovery to the latest point in time, DPM attempts to perform a SQL Server transaction log backup to receive the latest changes from the SQL Server database \<DatasourceName> on \<ServerName> before starting the recovery. This transaction log backup has failed.</li><li>DPM attempted to perform a SQL Server log backup, either as part of a backup job or a recovery to latest point in time job. The SQL Server log backup job has detected a discontinuity in the SQL Server log chain for \<DatasourceType> database \<DatasourceName> since the last backup. All incremental backup jobs will fail until an express full backup runs.</li></ul>| Performing backups by using WSB on a server that DPM is protecting can interfere with the backups that DPM uses.| If you are using WSB, do the following: <ul><li>Make sure that WSB always takes a **COPY** backup by using the WSB **Backup Once Wizard**. </li><li>If you are using WSB **Scheduled Backups**, make sure that the volumes that you are backing up contain no application data, such as Exchange Server data or SQL Server data. </li><li>After you reconfigure WSB, on the DPM server, run a new express full backup.</li></ul> |
  
## File server

| Issue| Possible cause| Resolution |
|---|---|---|
| A **Volume Missing** error occurs for some of your protected server volumes.| The DPM server cannot identify the volumes.| Follow these steps to remove the **Volume Missing** status. <br/><br/>1. In Administrator Console, select **Management**, and then select **Disks**.<br/>2. On the tool ribbon, select **Rescan**. The current disk data is displayed. <br/>3. Close Administrator Console, and then restart it. Check for any missing volume alerts in the details pane, and address them. <br/>4. In the **Protection** task area, verify that DPM removed the **Volume Missing** status. |
| Inconsistent drive letter references in the New Protection Group Wizard.| If you change a volume drive letter and don't restart the computer before you create a protection group for that volume, inconsistent drive letter references may appear in the New Protection Group Wizard.| To display the correct drive letters in the New Protection Group Wizard, you must update the drive letters in SQL by following these steps: <br/><br/>1. Remove the volume from the protection group, keeping the replicas.<br/>2. Read the volume to the protection group. |
| The recovery point time is not consistent with synchronization time.| When a recovery point is created, it reflects the time of the most recent change to the protected volume.<br/><br/>For example, if a recovery point is scheduled to be created at 11:00 A.M. and the most recent change to the protected volume occurred at 8:30 A.M., the recovery point that was created at 11:00 A.M. will display a time stamp of 8:30 A.M.| No action is required. |
| Replicas are marked as inconsistent.| After a volume is marked as **Missing**, DPM only brings the volume back online during the next disk modification operation, such as **Allocate disk space**, or after restarting the computer. DPM then marks the replica as inconsistent.| You must run a manual consistency check. For information about performing a consistency check, in DPM Help, see How to Synchronize a Replica. |
  
## Client computers

| Issue| Possible cause| Resolution |
|---|---|---|
| Recovery points are missing.| If scheduled recovery point creation and synchronization/consistency check for a client are run at the same time, the recovery point creation is skipped.| To avoid the loss of a recovery point for such clients, schedule an additional recovery point creation at a low-usage time so that the client computers that miss the recovery point creation have a recovery point created later. |
| Backups of client computers that are connected to corporate network through DirectAccess failure with RPC server unavailable error.| Edge traversal is blocked in the firewall settings.|<br/>1. Open the Windows Firewall console (select **Start**, select **Run**, and then type **firewall.cpl**).<br/>2. In the left pane, select **Advanced settings**.<br/>3. Select **Inbound rules**, and then scroll down to **DPMRA** and **DPMRA_DCOM_135**.<br/>4. Double-click each rule, and then navigate to the **Advanced** tab.<br/>5. In the **Edge traversal** group item, select **Allow edge traversal**. |
| **Access denied** when you try to retrieve information from the Windows Management Instrumentation (WMI) service.| This error can occur when you try to add a computer that is running Windows XP SP3 to the DPM server and a Group Policy setting is blocking the WMI service on the subject computer.| To resolve this error, do the following: <ol><li>On the computer that you want to add, select **Start**, select **Run**, type **regedit**, and then click **OK**. <br/><br/>**Caution** Serious problems can occur if you modify the registry incorrectly. These problems could require you to reinstall the operating system. Microsoft cannot guarantee that these problems can be solved. Modify the registry at your own risk. Always make sure that you back up the registry before you modify it, and that you know how to restore the registry if a problem occurs. </li><li>Locate the following registry subkey, and then delete it: <br/>`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MicrosoftFirewall\DomainProfile\RemoteAdminSettings` </li><li>Restart the computer, and then try to add the targeted computer to the DPM server again.</li></ol> |
  
## SharePoint

| Issue| Possible cause| Resolution|
|---|---|---|
|The SQL Server alias does not resolve on the SQL Server Agent and protection for the Windows SharePoint Services farm fails.|The Windows SharePoint Services farm is unable to use a SQL Server alias that was created by using cliconfg.exe.|You must reconfigure the SQL Server alias by using the SQL Server Configuration Manager.|
| |Not all the SQL Server aliases are configured on the front-end web server.| Check the list of servers on the Central Administration page of the SharePoint farm. Identify the SQL Server aliases from the list of SQL Server computers. Determine whether all the SQL Server aliases are configured on the SharePoint front-end web server (the one that communicates with the DPM server). |
| |The SQL Server alias is not of type TCP/IP.| DPM supports only TCP/IP SQL Server aliases. Reconfigure the aliases to type TCP/IP. |
| |SQL Server client connectivity components are not installed on the front-end web server.| Install the SQL Server client connectivity components on the front-end web server. |
| |For Windows SharePoint Services 3.0/MOSS 2007 farms, SQL Server 2005 client connectivity components are not installed on the front-end web server.| Regardless of the version of SQL Server on the back-end servers, for MOSS 2007 and Windows SharePoint Services 3.0, you should install the SQL Server 2005 client connectivity components on the front-end web server. Also, make sure that all the aliases are configured by using this version of the client connectivity components. |
| Windows SharePoint Services database log files are not truncated.| If the path of any Windows SharePoint Services database log file exceeds 150 characters, DPM cannot truncate the log file.| We recommend running periodic scripts to truncate your Windows SharePoint Services database log files. |
| |The **Copy-Only** registry value is set for the specific SharePoint farm on the DPM server.| This registry entry has to be deleted. It is in the following path on the DPM server with the name the same as the name of the Config database of the farm:<br/> `HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft Data Protection Manager\CopyBackups` |
| |The **Do not truncate logs** setting is enabled for the SQL Server on which the SharePoint databases reside.| This can be reset by using the following Windows PowerShell command: <br/> `Set-DPMGlobalProperty -Dpmserver $DPMMachineName -TruncateSharePointDbLogs $true`|
| The server process could not be started because the configured identity is incorrect. Check the user name and password (0x8000401A).| If the password is reset for the Windows SharePoint Services farm, protection will fail.| At the command prompt, run **ConfigureSharePoint.exe** to reset the password.<br/><br/>For more information about how to manage password changes, see [Plan for administrative and service accounts in SharePoint Server](/sharepoint/security-for-sharepoint-server/plan-for-administrative-and-service-accounts). |
| **Replica inconsistent** alerts for one or more SQL Server databases that were previously a part of the SharePoint farm appear in the Monitoring pane.| DPM keeps the existing recovery points of the databases that are removed from the SharePoint farm. This can occur if the removed database is recovered by using DPM or if DPM was upgraded.| Resolve the alert by selecting **Inactivate the alert**. |
| Some SharePoint farm's consistency check jobs seem to have stopped (no data transfer has occurred for a long time).| The consistency check was triggered while recovery of one of the farm's components was in progress.| Cancel the consistency check job and restart the consistency check for the farm from the Protection pane. |
| The SharePoint catalog task fails with HR 0x80004003 (Invalid Pointer).| There is a network connectivity issue between the SharePoint front-end web server and the back-end server.| Rerun the catalog job by using Windows PowerShell. |
  
## Exchange Server

| Issue| Possible cause| Resolution |
|---|---|---|
| DPM cannot protect Exchange Server data.| The eseutil.exe and ese.dll versions that are installed on the most recent edition of Exchange Server must be the same versions that are installed on the DPM server.| You must update eseutil.exe and ese.dll on the DPM server if they are updated on a computer that is running Exchange Server after an upgrade or an update.is applied.|
| After you rename an Exchange Server storage group, the new name does not appear in the New Protection Group Wizard.| If you use the original storage group name, data recovery fails when you try to unmount the database.| After you rename an Exchange Server storage group, you must restart the Microsoft Exchange Information Store service before you create a new protection group.<br/><br/>To start the Microsoft Exchange Information Store service <br/>1. Select **Start**, point to **Administrative Tools**, and then select **Services**.<br/>2. On the **Services** screen, scroll down, right-click **Microsoft Exchange Information Store**, and then select **Restart**. |
| DPM doesn't support incremental backups if circular logging is enabled for Exchange Server storage groups.| You cannot enable circular logging if you want incremental backups for Exchange Server storage groups.| For successful incremental backups, we recommend that you disable circular logging for the protected storage group. After you disable circular logging, restart the Microsoft Exchange Information Store service (MSExchangeIS).<br/><br/> **To disable circular logging** <br/>1. Select **Start**, point to **Programs**, point to **Microsoft Exchange**, and then select **System Manager**.<br/>2. If the Administrative Groups branch exists in the navigation pane, expand it, expand the appropriate administrative group's branch, expand the Servers branch, and then expand the appropriate server's branch. <br/><br/> If the Administrative Groups branch does not exist, expand the Servers branch in the navigation pane, and then expand the appropriate server's branch. (To expand a branch, double-click the branch or select the plus sign (+) to the left of the branch.) <br/>3. Right-click the storage group for which you want to disable circular logging, and then select **Properties.** <br/>4. Clear the **Enable Circular Logging** check box, and then select **OK**. <br/>5. Restart the Microsoft Exchange Information Store service (MSExchangeIS).  <br/> <br/>**To restart MSExchangeIS** <br/>1. Select **Start**, select **Run**, and then type **services.msc** to start the Services snap-in.<br/>2. Right-click **Microsoft Exchange Information Store**, and then select **Start**. <br/> **Note** If you do not want to disable circular logging, you can modify the protection group properties so that synchronizations occur just before you create the recovery point. <br/><br/>**To change the synchronization frequency** <br/>- In the New Protection Group Wizard, on the **Specify Short-Term Protection Policy** page, select **Just before a recovery point**. |
| Replica initialization and express full backup operations stop before completion.| When you are protecting data on a computer that is running a version of Exchange Server, the DPM server must include the Ese.dll and eseutil.exe files that are located in the Exchange Server installation location.| To protect data on a computer that is running Exchange Server, follow these steps: <br/>1. On the computer that is running Exchange Server, copy **Ese.dll** and **eseutil.exe** from the Exchange Server installation location to the DPM server installation location. The default installation location on the DPM server is \<drive>:\Program Files\Microsoft Data Protection Manager\DPM\bin.<br/>2. Cancel the replica initialization and express full backup jobs that did not finish. <br/>3. Restart the canceled express full backup jobs. <br/>4. Run a synchronization with consistency check for canceled replica initialization jobs.  <br/><br/>**Note** We recommend that you use the same processor architecture for the DPM server and the computer that is running Exchange Server.<br/><br/>If your processor architecture is different, you must do the following: <br/>1. Install the version of Exchange Server that you are protecting on a test server that is consistent with the hardware of the DPM server.<br/>2. From the test server, copy **Ese.dll** and **eseutil.exe** from the Exchange Server installation location to the DPM server installation location. The default installation location on the DPM server is \<drive:>\Program Files\Microsoft Data Protection Manager\DPM\bin. |
| The VSS writer does not clear **Backup in progress state** for the storage group.| In the released versions of Exchange Server 2007 and Exchange Server 2003, if you cancel the backup on a storage group in a particular interval (between PrepareForBackup and DoSnapshot), the VSS writer doesn't clear **Backup in progress state** for the storage group.| To recycle the VSS writer for:<br/><br/> **Event ID 2024 A**  - Restart the Microsoft Exchange Information Store service to recycle the VSS writer.<br/><br/> **Event ID 2024 B** - Restart the Exchange Server Replication service (Exssrv.exe) to recycle the VSS writer. |
| The Microsoft Exchange Information Store service does not appear on the **Select Group Members** page of the New Protection Group Wizard.| If the Exchange Local Continuous Replication (LCR) VSS replica writer is enabled, the Microsoft Exchange Information Store service will not appear on the **Select Group Members** page of the New Protection Group Wizard.| To display the Exchange LCR-enabled storage groups in the DPM New Protection Group Wizard, use the following set key command to disable the (LCR) VSS replica writer: <br/><br/>Registry location: <br/>`HKEY_LOCAL_MACHINE\Software\Microsoft\Exchange\Replay\Parameters` <br/>DWORD name: `EnableVssWriter` <br/>Value data: **0**  |
| All data replication jobs fail.| If the versions of Exchange Server Database Utilities (eseutil.exe) and ese.dll that are installed on the most recent edition of the protected Exchange Server differ from the versions that are installed on the DPM server, all data replication jobs will fail.| The eseutil.exe and ese.dll versions that are installed on the most recent edition of Exchange Server must be the same versions that are installed on the DPM server. For example, if you are protecting Exchange Server 2003 SP2, Exchange Server 2007, and Exchange Server 2007 SP1, you must copy eseutil.exe and ese.dll from the server that is running Exchange Server 2007 SP1 to the DPM server.<br/><br/>The following scenarios show the versions of eseutil.exe and ese.dll that you must install on the DPM server: <ul><li>32-bit operating system <br/> <br/>  - If DPM is protecting only computers that are running Exchange Server 2003 on a 32-bit operating system, copy eseutil.exe and ese.dll from the computer that is running Exchange Server 2003. <br/>  - If DPM is protecting computers that are running Exchange Server 2007, the 32-bit versions of eseutil.exe and ese.dll are required from Exchange Server 2007. You can get these versions from the Exchange Server 2007 Setup DVD. </li><br/><li> 64-bit operating system <br/> <br/>  - If DPM is protecting only computers that are running Exchange Server 2003 on a 32-bit operating system, copy eseutil.exe and ese.dll from the computer that is running Exchange Server 2003. <br/>  - If DPM is protecting Exchange Server 2007, copy eseutil.exe and ese.dll from the computer that is running Exchange Server 2007. </ul>|
| Exchange Server protection fails.| If the Exchange writer is turned off for the Volume Shadow Copy Service in Windows Small Business Server 2003, protection will fail.| By default, the Setup program for Windows Small Business Server 2003 turns off the Microsoft Exchange Server 2003 writer for the Volume Shadow Copy Service. To protect data that uses DPM, the Exchange Server 2003 writer must be turned on.<br/><br/>**To turn on the Exchange writer** <br/>1. Select **Start**, select **Run**, type **regedit**, and then select **OK**.<br/>2. Locate and then double-click the following registry subkey: <br/>`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MSExchangeIS\ParametersSystem` <br/><br/>3.  Double-click the **Disable Exchange Writer** value. <br/>4. In the **Value data** text box, change the value from **1** to **0**, and then select **OK**. <br/> 5. Exit Registry Editor. <br/>6. Select **Start**, point to **Administrative Tools**, and then select **Services**. <br/>7. Stop and then restart the Microsoft Exchange Information Store service. |
| Local continuous replication (LCR) protection fails and returns a Volume Shadow Copy Service (VSS) error.| If the Exchange Server replication service isn't restarted after the registry key is set, LCR fails for the storage group.| Restart the replication service after you update the registry key. |
| Setting and unsetting the _eseutil_ flag through the command-line interface (CLI) fails.| The preferred server may not have been specified.| Provide the topology as `PT_CCR_ACTIVE_ONLY` together with the `RunEseUtilConsistencyCheck` option. |
| The consistency check fails and returns **RMGenericError**.| The consistency check will fail if indexing, encryption, or Single Instance Storage (SIS) is enabled for the folder that contains the .edb file.| To resolve this issue, disable indexing, encryption, and SIS for the folder that contains the .edb file. |
  
## System protection

| Issue| Possible cause| Resolution|
|---|---|---|
| Bare Metal Recovery (BMR) backups fail and return an **Access Denied** error.| You have migrated from System State protection to BMR protection.|<br/>1. Remove BMR protection. <br/>2. Modify protection group and include BMR protection. |
| One or more prerequisites for protecting this data source are missing on your Windows Server 2008 operating system.| This error occurs if the Windows Server Backup utility isn't installed on the protected server.| To resolve this issue, do the following: <br/>- To install the Windows Server Backup utility, open a command prompt with administrative credentials and run:<br/><br/> `Start /wait ocsetup WindowsServerBackup /quiet /norestart` <br/><br/> **Note** To open a command prompt with administrative credentials, select **Start**, point to **All Programs**, select **Accessories**, right-click **Command Prompt**, and then select **Run as administrator**. |
  
## Virtual server

| **Issue**| **Possible cause**| **Resolution** |
|---|---|---|
| You may see the error message **One or more volumes are missing for the following application: \<Virtual machine name>. Make sure that the dependent volumes for the data sources are online** when you select a Virtual Server 2005 R2 based virtual machine.| For Virtual Server 2005 R2, DPM doesn't support backing up virtual machines hosted on a volume that doesn't have a drive letter.<br/><br/> **Note** This problem doesn't apply to Hyper-V virtual machines.| Provide a drive letter mount point for the volumes on which the VHD files exist and try to select for backup with DPM again. |
| Data on the virtual machine is unavailable for protection.| Virtual Server 2005 R2 Service Pack 1 (SP1) may not be installed on the server that you want to protect.| Install Virtual Server 2005 R2 Service Pack 1 (SP1) on the server that you want to protect. |
| Backup fails on the virtual machine with unknown error 0x800423f3.| The Virtual Server VSS Writer service doesn't support online backup for the client virtual machine.| Use Windows Event Viewer on the Virtual Server machine to determine whether Event ID 1044 exists. If this event exists, the virtual machine cannot run online backups.<br/><br/>You can run offline backups by updating the following registry subkey.<br/><br/>Locate:<br/><br/> `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Virtual Server\1.0\Backup\BackupType\<VMNAME>` <br/><br/>Set the value to **0**. |
| Online backup fails.| Online backups fail if the virtual machine contains volumes that don't support shadow copies (FAT 32 file systems). Additionally, if the shadow copies exist on different virtual machine volumes, the backup fails.| Make sure that the virtual machine is running before configuring the backup, and then delete the entries for the virtual machines for which the online backup is failing.<br/><br/> `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Virtual Server\1.0\Backup\BackupType`. |
